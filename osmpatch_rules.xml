<?xml version='1.0' encoding='UTF-8'?>
<!-- Командный файл для обработки osm-файла с помощью утилиты osmpatch -->
<osmpatch>
<patchset>
	<!-- Ищем элемент с тегами:-->
	<find>
		<!-- Задаём, какие типы элементов обрабатываем -->
		<type nodes='yes' ways='yes'/>
		<tag>
			<!-- full_match='no' - значит условие выполнится, если в OSM-теге найдётся искомая строка, если же full_match='yes' - условие выполнится, 
				 если строки полностью совпадут. (по умолчанию - yes)
				 no_case_sensitive='yes' - поиск производится без учёта регистра символов в строках (по умолчанию - no)
				 -->
			<key full_match='yes'>power</key>
			<value full_match='yes'>station</value>
		</tag>
		<tag>
			<key full_match='yes'>name</key>
			<value full_match='no' no_case_sensitive='yes'>ПС</value>
		</tag>
		<!-- параметр skip='yes' указывает, что OSM-элементы, имеющие данные теги и значения - будут исключаться из поиска -->
		<tag skip='yes'>
			<key full_match='yes'>name</key>
			<value full_match='no'>110</value>
		</tag>
		<tag>
			<key full_match='no'>source</key>
			<!-- если тег <value> не указан, то ищутся все элементы с тегом значения <key> и любым значением <value> -->
		</tag>
	</find>

	<!-- Если такой элемент найден, то обрабатываем его:-->

	<add>
		<!-- Добавляем теги к элементу (заменя при наличии) -->
		<tag k='power_usage_percent' v='95' />
    	<tag k='power_usage_date' v='2013.10.07' />
	</add>

	<del>
		<!-- Удаляем теги и их значения. Значения тегов в данном случае не нужны - в любом случае тег удаляется. -->
		<tag k='test_tag_for_delete' />
	</del>

	<replace>
		<!-- Заменяем значение тега, если такой тег существует -->
		<tag k='replace_tag_test' v='95' />
	</replace>
</patchset>

<!-- Правил <patchset> может быть много -->

<patchset>
	<!-- Ищем элемент с тегами:-->
	<find>
		<type nodes='yes' ways='yes'/>
		<tag>
			<key full_match='yes'>ref</key>
			<value full_match='no' no_case_sensitive='no'>КТП</value>
		</tag>
	</find>

	<!-- Если такой элемент найден, то обрабатываем его:-->

	<add>
		<!-- Добавляем теги к элементу (заменя при наличии) -->
		<tag k='power_usage_percent' v='95' />
    	<tag k='power_usage_date' v='2013.10.07' />
	</add>

	<del>
		<!-- Удаляем теги и их значения. Значения тегов в данном случае не нужны - в любом случае тег удаляется. -->
		<tag k='test_tag_for_delete' />
	</del>

	<replace>
		<!-- Заменяем значение тега, если такой тег существует -->
		<tag k='replace_tag_test' v='95' />
	</replace>
</patchset>

</osmpatch>
